From c02703c3dbe113fef52592e95722f72efd2c9f65 Mon Sep 17 00:00:00 2001
From: Marc Pavot <m.pavot@gmail.com>
Date: Mon, 31 Jan 2011 23:30:49 +0000
Subject: Patch 3106565 : libnotify 0.7.0 remove some functions (From Sardem FF7)

git-svn-id: https://ario-player.svn.sourceforge.net/svnroot/ario-player/trunk@740 a3c249ba-b837-0410-a99a-8c7cbf76920c
---
diff --git a/configure.ac b/configure.ac
index 55238b3..026bdd9 100644
--- a/configure.ac
+++ b/configure.ac
@@ -229,9 +229,15 @@ AC_ARG_ENABLE(notify,
 if test x"$enable_notify" != xno; then
    PKG_CHECK_MODULES(NOTIFY, libnotify)
    AC_DEFINE(ENABLE_LIBNOTIFY, 1, [Add support of libnotify])
+   # Check for libnotify >= 0.7
+   PKG_CHECK_MODULES(LIBNOTIFY_07, [libnotify >= 0.7], [have_libnotify_07=yes],[have_libnotify_07=no])
+   if test x"$have_libnotify_07" = "xyes"; then
+      AC_DEFINE(HAVE_LIBNOTIFY_07, 1, [Define if you have libnotify 0.7 or later])
+   fi
 fi
 AM_CONDITIONAL(USE_NOTIFY, test x"$enable_notify" != xno)
 
+
 dnl ================================================================
 dnl AUDIOSCROBBLER
 dnl ================================================================
diff --git a/plugins/libnotify/ario-notifier-libnotify.c b/plugins/libnotify/ario-notifier-libnotify.c
index b9bd6ff..ca65a27 100644
--- a/plugins/libnotify/ario-notifier-libnotify.c
+++ b/plugins/libnotify/ario-notifier-libnotify.c
@@ -122,9 +122,14 @@ ario_notifier_libnotify_init (ArioNotifierLibnotify *notifier_libnotify)
         ARIO_LOG_FUNCTION_START;
         notifier_libnotify->priv = ARIO_NOTIFIER_LIBNOTIFY_GET_PRIVATE (notifier_libnotify);
 
-        notifier_libnotify->priv->notification = notify_notification_new ("Ario",  NULL, NULL, NULL);
+        notifier_libnotify->priv->notification = notify_notification_new ("Ario",  NULL, NULL
+#if HAVE_LIBNOTIFY_07
+           );
+#else
+           , NULL);
         notify_notification_attach_to_status_icon (notifier_libnotify->priv->notification,
                                                    GTK_STATUS_ICON (ario_tray_icon_get_instance ()));
+#endif
 }
 
 static void
--
cgit v0.9
