# Copyright 2009 Hong Hao <oahong@gmail.com>
# Distributed under the terms of the GNU General Public License v2

require cmake flag-o-matic

SUMMARY="a portable, flexible file i/o abstraction library for video games"
HOMEPAGE="http://icculus.org/physfs"
DOWNLOADS="${HOMEPAGE}/downloads/${PNV}.tar.gz"

LICENCES="zlib"
SLOT="0"
PLATFORMS="~x86"
MYOPTIONS="doc"

DEPENDENCIES="
    build:
       doc? ( app-doc/doxygen )
    build+run:
        sys-libs/zlib
"

UPSTREAM_CHANGELOG="${HOMEPAGE}/downloads/CHANGELOG"
UPSTREAM_REALEASE_NOTES="http://icculus.org/pipermail/physfs/2009-March/000697.html"

DEFAULT_SRC_PREPARE_PATCHES=( "${FILES}"/${PN}-doc-option.patch )
CMAKE_SRC_CONFIGURE_PARAMS=(
    -DPHYSFS_BUILD_TEST:BOOL=FALSE
    -DPHYSFS_BUILD_WX_TEST:BOOL=FALSE
)
CMAKE_SRC_CONFIGURE_OPTIONS=( 'doc PHYSFS_BUILD_DOCS' )

#FIXME:
pkg_setup() {
    append-flags "-fno-strict-aliasing"
}
